package mntanproject.core.server.request;

import java.io.InputStream;
import java.util.Scanner;

public class HttpRequestFactory {

	public HttpRequest create(InputStream is)throws Exception {
	
		Scanner scanner = null;
		scanner = new Scanner(is);
		String startLine = null;
		HttpMethod method = null;
		String uri = null;
		String version = null;
	
	
		if (!scanner.hasNextLine()) {
			throw new IllegalArgumentException("Invalid Startline");
		
		}
		
		startLine= scanner.nextLine();
		System.out.println("startline: " + startLine + " length:" +startLine.split(" ").length);
		if (startLine != null) {
			System.out.println("splitting startline");
			
			if(startLine.isEmpty() && startLine.split(" ").length != 3) {
				method = extractMethodFrom(startLine);
				uri = extractUriFrom(startLine);
				version = extractHttpVersionFrom(startLine);
			}
		}
		//scanner.close();	
			System.out.println("method:" + method);
			System.out.println("uri:" + uri);
			System.out.println("version:" + version);
		return new HttpRequest(method, uri, version);
	}
	
	private HttpMethod extractMethodFrom(String startLine) {
		String methodName = startLine.split(" ")[0];
		return HttpMethod.valueOf(methodName);
	}
	
	private String extractUriFrom(String startLine) {
		return startLine.split(" ")[1];
	}
	
	private String extractHttpVersionFrom(String startLine) {
		return startLine.split(" ")[2];
	}
	
}
